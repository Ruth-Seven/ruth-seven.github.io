---
title: 1027 最长等差数列
thumbnail: 'http://static.come2rss.xyz/尼尔机械.jpg'
toc: true
top: 10
categories:
date: 2020-08-07 14:12:36
tags:
---

<!-- more -->



## [1027. 最长等差数列](https://leetcode-cn.com/problems/longest-arithmetic-sequence//)

### 思路：

求最长等差序列的长度，可以看出序列可以分解为多个序列，而且序列的选择不具有历史影响。可以可以考虑用DP做。用一个状态无法表示数列的等差量和数列的端点两个状态。所以至少得有两个状态，且可以用两个状态分别表示一个等差序列的最后两个元素下标。


DP方程可以这么写：

dp[i][j]={dp[k][i]+1,if k is element of the array 2,elsedp[i][j]={dp[k][i]+1,if k is element of the array 2,else



> 为啥是最后两个？因为为最后两个元素组成的最长等差序列，可以给后续DP方程计算。而两个元素作为开头无法递推！

```
class Solution {
public:

    int longestArithSeqLength(vector<int>& A) {        
        int n = A.size();
        //优秀的初始化方法
        // vector<int>(n, 2)动态生成了一个长度为n，每个元素为2的vector对象
        vector<vector<int> > dp(n, vector<int>(n, 2));
        map<int, int> idx;
        int maxRes = 2;
        for(int i = 0; i < (int)A.size() - 1; i++){
            for(int j = i + 1; j < A.size(); j++){
                int target = A[i] * 2 - A[j];
                if( idx.count( target )) dp[i][j] = dp[idx[target]][i] + 1;
                maxRes = max(maxRes, dp[i][j]);
            }
            idx[A[i]] = i;
        }
        return maxRes;
    }
};
```